<!DOCTYPE html>
<html lang="ko">
<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Visit Korea</title>
		
		<link rel="stylesheet" type="text/css" href="css/keyword.css" />
</head>
<body>
		
		<div id="bubble-chart"></div>
        <script src="../libs/react.production.min.js"></script>
        <script src="../libs/d3.min.js"></script>
		
<script>
    let data = {
        children: [
            {
                count: 2007,
                name: "Large WS Beauty"
            },
            {
                count: 825,
                name: "Medium Beauty"
            },
            {
                count: 293,
                name: "Small B Traditional"
            },
            {
                count: 624,
                name: "Small A Beauty"
            },
            {
                count: 193,
                name: "Small B Traditional"
            },
            {
                count: 83,
                name: "Small B Traditional"
            },
            {
                count: 383,
                name: "Small B Traditional"
            },
            {
                count: 624,
                name: "Small A Beauty"
            },
            {
                count: 193,
                name: "Small B Traditional"
            },
            {
                count: 83,
                name: "Small B Traditional"
            },
            {
                count: 383,
                name: "Small B Traditional"
            },
            {
                count: 1200,
                name: "Small B Traditional"
            }
        ] 
        }; 

        const total = d3.sum(data.children,(a)=>{
        return a.count; 
        
        })
        console.log(total);

        var diameter = 768;
        var color = d3.scaleOrdinal(d3.schemeCategory10);

        var bubble = d3
        .pack(data)
        .size([diameter, diameter])
        .padding(1.8);

        var svg = d3
        .select('#bubble-chart').append('svg')
        .attr("width", diameter).attr("height", diameter).attr("class", "bubble");

        var nodes = d3.hierarchy(data).sum(function(d) {
        return d.count;
        });

        var node = svg
        .selectAll(".node")
        .data(bubble(nodes).descendants())
        .enter()
        .filter(function(d) {
        return !d.children;
        })
        .append("g")
        .attr("class", "node")
        .attr("transform", function(d) {
        return "translate(" + d.x + "," + d.y + ")";
        })
        .on("mouseover", function(d) {
            this.setAttribute('cursor','pointer');
        })
        .on("mouseout", function(d) {
            this.removeAttribute("stroke", "black");
        });

        node.append("title").text(function(d) {
        return d.data.name + ": " + d.data.count.toLocaleString();
        });

        node
        .append("circle")
        .attr("r", function(d) {
            return d.r;
        })
        .style("fill", function(d, i) {
            return color(i);
        })

        node
        .append("text")
        .attr("dy", "1.4em").style("text-anchor", "middle")
        .text(function(d) {
            return d.data.name.substring(0, d.r / 3);
        })
        .attr("font-family", "sans-serif")
        .attr("font-size", function(d) {
            return d.r / 2;
        })
        .attr("fill", "white").attr("width","1em")


        node
        .append("text")
        .attr("dy", "0.2em")
        .style("text-anchor", "middle")
        .text(d => {
            return (
                (d.data.count / total * 100).toFixed(1) + "%"
            );
        })
        .attr("font-family", "Gill Sans", "Gill Sans MT")
        .attr("font-size", function(d) {
        return d.r / 5;
        })
        .attr("fill", "white")
        .on("click", d => {
        this.props.getReasonFromChart(d.data.name);
        });

	</script>
	</body>
</html>
